---
# file: wkhtmltopdf/tasks/package/main.yml
#
# tasks to install wkhtmltopdf using package.
#

- name: package | ensure wkhtmltopdf_installation package is possible for wkhtmltopdf_version
  fail:
    msg="wkhtmltopdf_installation package only possible on 0.12.2 and 0.12.1"
  when: wkhtmltopdf_version != '0.12.2' and wkhtmltopdf_version != '0.12.1'

- name: package | ensure wkhtmltopdf_installation package is possible for distribution version
  fail:
    msg="wkhtmltopdf_installation package only possible on ubuntu/trusty+precise or debian/wheezy"
  when: wkhtmltopdf_installation == 'package' and ansible_distribution_release not in ['precise', 'trusty', 'wheezy' ]

- name: package | download
  get_url:
    url="{{ wkhtmltopdf_download_url }}"
    dest="{{ ansible_env.HOME }}/{{ wkhtmltopdf_package }}"
    owner="{{ wkhtmltopdf_user }}"
    group="{{ wkhtmltopdf_user }}"
    mode=0440
    validate_certs=no
  become: yes

- name: package | installation
  apt:
    deb="{{ ansible_env.HOME }}/{{ wkhtmltopdf_package }}"
    state=present
  become: yes
  tags: installation
