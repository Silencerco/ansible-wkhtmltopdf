---
# file: wkhtmltopdf/tests/test.yml

- name: setup python2
  hosts: "{{ vagrant_box }}"
  gather_facts: no

  tasks:
    - raw: sudo apt-get update -qq && sudo apt-get install -qq python2.7
      when: playbook_python2 is defined and
            playbook_python2


- name: tests play
  hosts: "{{ vagrant_box }}"
  gather_facts: yes

  vars:
    debug: yes
    git_version: 2.11.0

  pre_tasks:
    - debug:
        msg="loading test variables from vars/{{ item }}"
      with_first_found:
        - skip: true
          files:
            - "{{ ansible_distribution | lower }}-{{ ansible_distribution_release | lower }}.yml"
            - "{{ ansible_distribution | lower }}.yml"
            - "{{ ansible_os_family | lower }}.yml"

    - name: include OS family/distribution specific variables
      include_vars: "{{ item }}"
      with_first_found:
        - skip: true
          files:
            - "{{ ansible_distribution | lower }}-{{ ansible_distribution_release | lower }}.yml"
            - "{{ ansible_distribution | lower }}.yml"
            - "{{ ansible_os_family | lower }}.yml"

  roles:
    - role: wkhtmltopdf

    - role: tests
      tags: test
